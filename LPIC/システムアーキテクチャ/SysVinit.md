# SysVinit

### SysVinitによる起動

Linuxで最初に実行されるプロセスであるinitが`/etc/inittab`ファイルの設定に従い、システムに必要なサービスを順次起動していく。

1. initが/etc/inittabを読み込む
1. initが/etc/rc.sysinitスクリプトを読み込む
1. initが/etc/rcスクリプトを実行する
1. /etc/rcスクリプトが「/etc/rc(ランレベル).d」ディレクトリ以下のスクリプトを実行する

### ランレベル

|ランレベル|RedHat,CentOS,Fedora|Ubuntu,Debian,GNU/Linux|
|---|---|---|
|0|停止|停止|
|1|シングルユーザモード|シングルユーザモード|
|2|マルチユーザモード|マルチユーザモード|
|3|マルチユーザモード|マルチユーザモード|
|4|未使用|マルチユーザモード|
|5|マルチユーザモード|マルチユーザモード|
|6|再起動|再起動|
|Sまたはs|シングルユーザモード|シングルユーザモード|

シングルユーザモードとはrootユーザだけが利用できる状態。

システムのメンテナンスなど一般ユーザがシステムを利用していては困るときに使用する。

### ランレベルの変更と確認

- `runlevel`
    - 前のランレベルと現在のランレベルと表示
    - Nはランレベルを切り替えていないときに表示される

- `init ランレベル`
    - ランレベルの切り替え
    - root時に使用できる
    - `telinit`コマンドも同様の操作
    - シングルユーザモードにする場合は予め`wall`コマンドでメッセージを送る

### 起動スクリプトによるサービス管理

各種サービスの起動には/etc/init.d以下に用意されている起動スクリプトが使用される。

/etc/rc3.dならばランレベルが3になった時に使用されるスクリプトファイルが配置される。

- 起動
    - httpdサービスを例に
    - `/etc/init.d/httpd start`

- 終了
    - httpdサービスを例に
    - `/etc/init.d/httpd stop`

### デフォルトのランレベル設定

`/etc/inittab`にデフォルトのランレベルが記載されている。

- 例
    - `id:5:initdefault:`
    - ランレベルが5に設定されている

