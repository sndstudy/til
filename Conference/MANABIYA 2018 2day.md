# MANABIYA 2018 2day

## 12:10 2018年のWeb標準 泉水 翔吾

### Service Worker

- ブラウザにインストールさせる Web Worker
- JavaScriptで実装できるネットワーク Proxy
- プッシュを受信したり、オンライン復帰時を検知したり
    - メッセージ送信時にオフラインになったが、復旧時にリトライするなど
    - プッシュ通知はもちろん、更新データの送信も
- ServiceWorkerは「オフライン対応のための技術」では無い

### Progressive Web Apps

- Googleが提唱する次世代Webアプリケーション
    - 高速に動作する、インストールできるetc
    - Webの良さを活かしつつ、ネイティブアプリの長所を取り入れる
- 要するにWebをもっと前に進めようという動き

### Service Workerのサポート状況

- Chrome
    - 対応済み
- Safari
    - 11.1から対応予定
- Firefox
    - 対応済み
- Edge
    - 対応予定

### Service Workerを使おう

- オプトインで導入可能。キャッシュだけでも使う価値有り
- PWA化するのは必須
- 特にSafariがサポートされるとモバイル方面で使える

### Web Components

- グローバルスコープなDOMにスコープが欲しい
    - CSSを扱うのが難しい問題の解決
    - Webの部品を再利用したい問題の解決
- コンポーネント化が定着してきた昨今のWeb開発
    - Reactをはじめとしたビューライブラリの流れ

### Web Componentsを司るWeb標準技術

- Custom Elements
    - 振る舞いを定義する
    - カスタム要素を登録する
    - Chrome,Safariは対応済み
- ShadowDOM
    - ShadowDOMを生やす
    - ShadowDOMを参照する
    - Chrome,Safariは対応済み
- ES Modules
    - Chrome,Safari,Edgeは対応済み
- 上記3つの技術はChrome,Safariが対応されているためモバイルで使っていける

### Web Componentsを使おう

- Web標準に立ち返ってみる
    - ブラウザランタイムで動作する廃れにくい技術
    - Web開発を次のステップへ
- 直接的なメリットもある
    - ツールや作法への学習コストなど、使う障壁が低い
    - ライブラリのロードコストがなくなる

### Web Payments

- Web上の決済を、もっと便利で安全にしたい
    - クレジットカードは便利だけど紛失時のリスクが大きい
    - Webサービスの利用時の入力も、双方にリスク
- Payment Request API
    - ブラウザでUIを提供して、決済体験のギャップを減らしたい

### Web Paymentsのコンセプト

- そもそもカード情報をやりとりしなければいいのでは
    - PaymentAppでトークンを発行してトランザクションを実行する
    - トークンはカード情報では無いので、万が一漏れても被害が小さい
- Payment Request API
    - Web Paymentsの仕組みをブラウザで利用するためのUI
    - クレジットカードの入力インターフェースだけでは無い

### ネイティブのPaymenntAppのフロー

1. ECサイトで商品購入
1. ブラウザがPaymentAppを起動
1. PaymentAppがカード会社にトークンを要求する
1. ブラウザがPaymentAppからトークンを取得する

### Payment Request APIのサポート状況

- Chrome、Edge
    - 対応済み
- Safari
    - iOS 11.3から
- Firefox
    - 開発中

### Web Paymentsを使おう

- 決済機能があるサービス事業者は是非
    - モバイルWebの決済体制がガラッと変わる
    - PSP(決済代行会社)が提供するSDKを使っている場合は対応を待つ

## 13:50 CrossSession プログラミング言語

## どんな風に勉強しているか

- 公式ドキュメント・チュートリアルを読む
    - わからない→ググるは泥沼にハマる
    - わかったことはブログにまとめる
- 本を読む
    - ネットは断片的な情報が多い
    - 本はターゲットがわかっているので勉強しやすい
    - 電子書籍を購入して読み機会を増やす

### プログラムをするときの設計方法

- データから考える
    - どうやったら一番データアクセスの効率が良いか考える
- 静的型付き言語の場合は型から設計する
- 動的型付き言語の場合はREPLで確かめてから実装することがある

### 綺麗に書くvsパフォーマンス速く書く

- 綺麗と速いはデータ構造が両立しない
- ベンチマークで遅いとわかるまで速く書かない

### バグが出にくいプログラミング

- 大きい関数を書かない
- 自分で作らない
    - ライブラリがあるならそれを使う
- 型を強くつける
    - 境界面(DBやHTTP通信など)のテストぐらいしかしていない


### コードリーディング

- ライブラリのアップデートでバグが出た時にコードを見る
    - バージョン管理ツールが便利
- grepやファイル名から推測する
    - 野生の勘
- GitHubで読むことが多い
- ある言語を基に作られた物の場合は構成が似ている場合がある

### プログラミングを続けていきたいか

- 趣味でやるのは楽しい
    - 仕事もこれが向いているので続けている
- 自分が楽しい、作れるから

## 15:40 CrossSession Web

### SPAってどんな感じ

- Full
- 部分的に適用
- SSRとSPAの併用
- Vue.js

### Router

- Angularの場合はangular/router
- Vueの場合はvue-router
- Reactはreact-routerだが疲弊している

### みんながSPAで作っているもの・作っていて困ったこと

- 戻った時にスクロール位置が回帰してくれないことがあった
- 社内の人と社外の人が一緒に使うツール
    - ServiceWorkerでキャッシュがパージされない
    - QAしてくれる人のキャッシュのパージが面倒
    - ServiceWorkerに更新がある時に実際に取ってきて更新するという処理を標準でやってほしい
- 状態管理が苦労している
    - JSの状態とページの状態の同期、トランザクション境界が壊れる

### JSFatigue実感ある?

- Vue.jsが好きなだけで追ってるわけではないので実感はないが、新しいbundleツールとかが出てくるとそれに対応しないといけないので大変
- Vue.jsはFlow/TypeScriptで書けるが今の所は TypeScriptが強い
- Angularは基本TypeScript、Firefox早くShadowDOM実装してくれと思っている。
- Node.jsのブラウザとCommonJSとで疲弊することもある。
- CustomElementsで何か実装すると、FirefoxのためにPolyfillが必要。
- webpackが嫌だ。
- CSS in JSが一般的になってきているがしっくり来ない

### 今後のWeb標準で期待したいことは

- WebAssembly
    - ポータビリティが増して、ライブラリとして入れられるようになったり、Web以外のライブラリも持ってきて動くと面白い
- DOMChangeList
    - DOMの変更をリスト化してブラウザに渡してバッチで処理するイメージ
- VDOMがやっている事を標準化してほしい

## 16:35 CrossSession 生存戦略

- ひと通りできるようになったら、若い人に伝えていく
- なぜCTOになったのか
    - もともと技術的にNo2だったため
- なぜ転職したか
    - Excel仕事が増えてきてこのままではヤバイと思ったため
    - 元々は変化がありそうなネットの業界に入った
    - ビビっていれば生存できる
- 変化に強いものが生き残る
    - 能力が強ければ良いというものではない
- 若い人に対してアドバイス
    - 勉強していれば大丈夫
    - オープンな場にコードを公開する
    - 自分にあった勉強方法を編み出す

## 17:25 LT大会 プログラミング

### プログラミングは楽しいのか?

- 完璧なコードなのにコンパイルエラー
    - ちがうコードを見ていた
- 日次バッチの処理が24時間
    - SQLにWhere句
- 勤怠管理システムで障害発生
    - 計算式が間違っていた
    - テストしっかりしよう
- おすすめ本
    - 独学プログラマー
- スキルアップし続ければ楽しい

### 目的別プログラミング言語の選び方

- 適性を確認する場合
    - JS
    - 書く→動くが速い
- Webサービス
    - PHP
    - OSSが豊富
    - 場合によってRubyもあり
- Webエンジニア
    - 未知の技術に対する柔軟な対応力
    - Java
    - 他のオブジェクト言語を学習する場合にコストが少ない
    - オブジェクト指向言語の中で癖が少ない
