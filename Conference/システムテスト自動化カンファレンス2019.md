# システムテスト自動化カンファレンス2019

- サイト
    - https://testautomationresearch.connpass.com/event/144768/
- テスト自動化スキル標準
  - https://sites.google.com/site/testautomationresearch/info/tesutozidonghuasukirubiaozhunautomationtestssfpublicbetawogongkaishimashita

---
## 13:15-13:45	AIを活用した交通事故削減サービスのテスト自動化(仮) / 鈴木翔太さん、馬 立東さん

- DRIVECHART
  - https://drive-chart.com/
- AI/MLシステムについてのテスト／QA
  - モデルの精度テスト
  - テストに用いるデータセットは適切か
  - テストデータをどうやって作成する?
  - そもそも何を持って品質保証というのか
    - 特定のデータセットでの精度xx%
    - 絶対失敗できないケースに通らない
- ソフトウェア開発との違い
  - 伝統的なソフトウェア開発フロー
    - 決定論的に振る舞いが決まる
    - 仕様を網羅して自動テスト可能
  - 機械学習の開発フロー
    - 入力データに対して確率的に振る舞いが決まる
    - 仕様を網羅できず部分集合に対するテストしかできない
    - エラーかどうかの検出が難しい
- CACE性
  - 少しでも変更すると全体に影響が及ぶ性質
  - 学習や変更が行われるたびに品質を保証する必要がある
- MLOps
  - DevOpsのML版?
  - AI/MLのCI/CD
    - 前処理の自動化
    - モデルの再学習の自動化
  - Data/model バージョニング != コードバージョニング
    - 学習の再現性
    - 実験結果の記録
    - 学習データ、モデルサイズが大きく単純にGit管理できない
- AIプロダクトの品質保証で考慮すべき軸
  - データがきちんとしていること
  - モデルがきちんとしていること
  - システム全体として何かが起きてもなんとかなる
  - AIプロダクト全体の品質が確保されている
  - プロセスが機動的であること
  - 顧客との良い関係性
- 取り組んでいるテスト/QA
  - モデル部分以外は普通のソフトウェアテストと同じ
  - モデルの性能試験は過去のデータを自動で大量に実行できるようにしておき差分を見る
  - テスト条件を洗い出してみる
    - 特に注意してテストを考えたいのはエッジケース
      - 意識して集めないとデータそのものがないことが多い
      - テストコースなどを使って収集する
    - 過剰品質にならないように関係者間で合意をとる
  - アノテーションの品質問題
    - 画像やテキストになんらかのタグをつける
    - モデルの学習はアノテーションを正しいものとして行うのでそもそものデータが間違っていると学習結果もおかしくなる
  - テスト環境
    - AWS
    - 使用するモデルやコードはパラメータとして設定
    - CVモデルを本番はエッジで動かしているがサーバサイドで動くようにして画像処理も再現
    - スポットインスタンスの積極活用でコストを抑える

---
## 13:45-14:00	EM(エンジニアリングマネージャー)×QA視点で進めるテスト自動化への取り組み / 斉藤健太さん

- EM役割
  - PM
  - チーム作り
  - メンバー育成
  - 技術導入検討
- QA役割
  - テスト計画
  - テスト仕様書レビュー
  - 障害分析/再発防止策検討
  - テスト自動化導入検討
- EMとして考えたこと
  - 利用技術
  - カバレッジ率
  - メトリクス測定
  - 開発フロー
  - 運用メンテナンス
  - 育成
  - テスト自動化をどう実現すべきかについてフォーカスしている
- QAとして考えたこと
  - 品質をあげる、コストを変えず、スピードをあげる(QCD)
    - ビジネス的な重要機能に絞る
    - テスト観点をベースとして自動化
      - 何を担保できている自動化なのか?
    - テスト自動化の要件を作っていくイメージ
  - 何を担保すべきかをメインにフォーカスしている
- 自動テスト推進の進め方
  - テスト自動化の導入比率
    - UI
      - 10%
    - Service
      - 20%(APIとか)
    - Unit
      - 70%

---
## 14:00-14:15	Serverless automation UI testing by using AWS Fargate / 引持力哉さん

- 自動システムテスト環境をEC2からFargateへ移行
- 自動システムテストフレームワーク
  - Bucky
    - E2E
    - Linkstatus
- EC2環境について
  - EC2内でコンテナを立ち上げて実行
  - ECRからimageを取ってくる
  - 1つのインスタンス内にテスト実行環境、レポート機能などが混ざっている
- 問題点
  - 柔軟なリソース管理ができない
- 実現したいこと
  - 柔軟なリソース管理がしたい
    - レポート機能を切り出す
    - テスト実行時のみインスタンスを立ち上げる
    - テスト実行ごとにリソース変更したい
      - Fargateの出番
    - タスク定義さえ用意しておけばテストに応じて柔軟にリソース管理できる
- 新テスト環境
  - EC2
    - レポート機能のみ
  - Fargate
    - テスト実行
  - コスト削減
    - 40%削減
  - 実行時間が短くなった
    - 効率よくリソースを割り当てられたため
- awsvpcネットワークモード
  - 同じコンテナ内はlocalhostとして扱える
  - nodeごとにポートが被ることがあるためタスク定義でポートを分けてあげること
- dokcerize
  - HTTPリクエストを投げて200が返却されるまで待つ設定ができる

---
## 14:30-15:00	テスト自動化プロジェクトを支える技術と仕組み / 伊藤由貴さん

- 抱えていた問題
  - 理想
    - 製品のQCD向上に寄与
  - 一部プロジェクトの現実
    - QCDが上がらない
    - 炎上
  - 要因
    - 社内の横の連携不足
      - 部署やチームごとに個別に頑張っている状態
    - エンジニアのテスト自動化スキル不足
      - 要因ガチャの状態
      - スキルがないとテスト自動化のお仕事ができず、仕事ができないと経験が積めずにスキルが身につかないというループ
    - マネージャーのテスト自動化知見不足
      - プロジェクトを進める上でのリスクを見落としていたり、見積もりの精度が低かったりする問題が起こる
- 取り組み
  - テスト自動化プロジェクトガイドラインを策定
    - テスト自動化プロジェクトを進めるにあたって必要なことをまとめたガイドライン
      - テスト自動化の目的、成功要因と失敗要因
      - gTAA,TAA,TAS
      - テスト自動化プロジェクトマネジメント
      - 自動化する/しないの選定
  - 標準プロセスの設定
    - テスト自動化をどう進めていけば良いのか全体像を明確にするために標準プロセスを設定した
  - テスト自動化エンジニアのロール・スキルの定義
    - テスト自動化プロジェクトを行うために必要なロールを明示
    - テスト自動化に必要なスキルを可視化
    - ロール
      - 自動テストシステムアーキテクト
        - CIを含めた自動テストシステムの設計ができる
      - 自動テストPM
        - 自動テストシステムの要件定義ができる
      - テスト自動化プランナー
        - テスト自動化ツールの選定ができる
        - お役様のテスト計画のどこをいつ自動化できるかを見極められる
      - 自動テストシステム運用エンジニア
      - テスト自動化エンジニア
        - スクリプトが書ける
  - 社員教育
    - Pythonプログラミング、単体テスト
    - Selenium + Pythonでのテスト自動化
    - Gitを使ったバージョン管理
    - JEnkinsでのCI構築
    - 商用の自動テストツールを使ったテスト自動化
- 成果と今後
  - 社内のノウハウ共有が促進
  - プロジェクトの安定運営
    - joinするメンバーのレベルの底上げ
  - 文化の浸透
    - 社内でテスト自動化の文化が広まってきた
    - 非エンジニア職からもテスト自動化を学びたいという要望が出ており、教育を行なっている

---
## 15:00-15:30	会社レベルの「テスト自動化普及」ミッションに立ち向かう話 / 松木直之さん

- なぜ普及させる
  - 自動テストが当然となる環境や時代への危機感
    - 競争力の低下
    - SE価値の低下
  - テストにフォーカスできないことへの危機感
    - 技術的負債
    - 成長不安
- 見解
  - それぞれのPJで培ったノウハウがあるけど何かあったら人海戦術
  - テストは新人にやらせたり、害虫に丸投げしてたり
    - 感覚的に物を言い過ぎ
- 自動テストができない理由
  - 人がいない
  - コストが見込めない
  - 製造は外注次第
  - できるように改善する
    - 力が及ばないところもある
      - 人、金、時間
- ちゃんと知らない
  - 自動テストも結構やっている
  - ただしレベルの幅は広そう
  - 互いによく知る
    - そもそもテストの情報が少ない
    - 意思と手段が必要
    - 知らせる相手側に興味がない
- 普及とは何だろう
  - どんなテストを
  - どんくらいすれば普及
  - 我々がどうなればいいのか明確に宣言できていなかった
  - ゴールを決めて計測する
    - 普及の定義どうするか
    - 計測の方法や数字が難しい
- 何を計測するか
  - 自動テストの実施率
    - テストタイプや手段ごと
    - テストツールの利用率
  - 教育受講率、理解度
  - 状況の変化
    - 事例の増加
    - テスト組織や取り組みの立ち上がり
- どう計測するのか
  - 常時収集できるもの
    - ライセンス数
    - DL数
  - 収集しにくいもの
    - アンケート
    - ヒアリング
- やってること
  - ツールを定める、いっそ作る
    - テストツールを作る
    - または得意なツールを定める
    - そのツールの布教、サポート、教育などをやっていく
  - 教育
    - ライブ配信やワークショップ形式で実施

---
## 15:45-16:15	Karateによる開発プロセス改善の事例と、Zipkinと連携したマイクロサービスの障害点検知の仕組み / 高橋勲さん

- APIテストしてもらえない問題
  - APIは画面があるサービスで間接的にテストされる
  - テストシナリオ次第なのでAPIに対するテストケースとして不十分
- APIテストのメンテが大変
  - できる≠使いやすい
    - PostmanなどのGUIツール
    - JUnitなどのテストフレームワーク
    - REST API特化型のフレームワーク
    - curl(辛い)
- Karateとは
  - APIテストのフレームワーク
  - mockAPIサーバにもなる
- 普及活動
  - 開発チームと一緒にテストを書いていく
- 成果
  - 本番環境での障害削減
  - 障害の早期検出
  - 開発チームの自主性が向上
- Karateが品質をあげるDevの行動を促す
- 分散トレーシング
  - 複数のサービスにまたがる処理を分析する仕組み
    - microservice
    - どのサービスのパフォーマンスがボトルネックになっているか
- Sebas
  - API Testing Platform
  - ローカル・CI上で実行したテスト結果の閲覧・管理

---

## LT



